# GitHub Actions - è‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨
name: Deploy to Server

on:
  push:
    tags:
      - 'v*'
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout ä»£ç 
        uses: actions/checkout@v4

      - name: éƒ¨ç½²åˆ°æœåŠ¡å™¨
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SERVER_HOST }}
          username: ${{ secrets.SERVER_USER }}
          key: ${{ secrets.SERVER_SSH_KEY }}
          port: ${{ secrets.SERVER_PORT }}
          script: |
            cd /opt/sora-ui-deploy
            
            # æ‹‰å–æœ€æ–°é•œåƒ
            docker pull ghcr.io/${{ github.repository }}:latest
            
            # é‡å¯å®¹å™¨
            docker compose up -d admin
            
            # æ˜¾ç¤ºçŠ¶æ€
            docker compose ps
            
            echo "âœ… éƒ¨ç½²å®Œæˆ"
            echo "ğŸŒ è®¿é—®: https://admin.zuo2799662352.xyz"

